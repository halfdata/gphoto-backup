{% extends "base.html" %}

{% block content_wrapper_class %}content-wrapper-wide{% endblock %}
{% set active_menu_item = 'browser' %}
{% set subheader = user.email + "'s media" %}
{% block content %}
    {% if mediaitems %}
        {% if total_pages > 1 %}
            {% include 'paginator.html' %}
        {% endif %}
        <div class="images-container">
            {% for mediaitem in mediaitems %}<div class="image-container"><a href="{{ url_for('library_mediaitem', user_id=user.id, mediaitem_id=mediaitem.id) }}"><img style="height: 160px; width:{{ (160*mediaitem.width/mediaitem.height)|int() }}px" src="{{ url_for('library_thumbnail', user_id=user.id, mediaitem_id=mediaitem.id) }}" /></a></div>{% endfor %}
        </div>
        {% if total_pages > 1 %}
            {% include 'paginator.html' %}
        {% endif %}
        <script>
            var inputs = document.getElementsByClassName('paginator-current-page')
            for (var i=0; i<inputs.length; i++) {
                inputs[i].addEventListener("keyup", (event) => {
                    var input = event.target || event.srcElement;
                    var max_value = parseInt(input.getAttribute('max-value'))
                    var value_str = input.value;
                    if (isNaN(value_str) || isNaN(parseInt(value_str)) && value_str != '') {
                        input.value = 1
                        return
                    }
                    value = parseInt(value_str)
                    if (value < 1) {
                        value = 1
                        input.value = 1
                    } else if (value > max_value) {
                        value = max_value
                        input.value = max_value
                    }
                    if (event.keyCode == 10 || event.keyCode == 13) {
                        window.location.href = "{{ url_for('user_mediaitems', user_id=user.id) }}/" + value;
                    }
                });
            }
        </script>
    {% else %}
    <div class="users-container">
        <p>No media items found. Seems this user never created backup. ;-)</p>
    </div>
    {% endif %}
{% endblock %}