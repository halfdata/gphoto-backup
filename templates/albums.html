{% extends "base.html" %}

{% block content_wrapper_class %}content-wrapper-wide{% endblock %}
{% set active_menu_item = 'browser' %}
{% set submenu = True %}
{% set active_submenu_item = 'albums' %}
{% set subheader = user.email + "'s albums" %}
{% set base_url = url_for('user_albums', user_id=user.id) %}

{% block content %}
    {% if albums %}
        {% if total_pages > 1 %}
            {% include 'paginator.html' %}
        {% endif %}
        <div class="albums-container">
            {% for album in albums %}
                <div class="album-container">
                    <div class="album-thumbnail" style="background-image:url({{ url_for('library_thumbnail', user_id=user.id, mediaitem_id=album.mediaitem_id) }});"></div>
                    {{ album.title }}
                    <a href="{{ url_for('user_albumitems', user_id=user.id, album_id=album.id) }}"></a>
                </div>
            {% endfor %}
        </div>
        {% if total_pages > 1 %}
            {% include 'paginator.html' %}
        {% endif %}
        <script>
            var inputs = document.getElementsByClassName('paginator-current-page')
            for (var i=0; i<inputs.length; i++) {
                inputs[i].addEventListener("keyup", (event) => {
                    var input = event.target || event.srcElement;
                    var max_value = parseInt(input.getAttribute('max-value'))
                    var value_str = input.value;
                    if (isNaN(value_str) || isNaN(parseInt(value_str)) && value_str != '') {
                        input.value = 1
                        return
                    }
                    value = parseInt(value_str)
                    if (value < 1) {
                        value = 1
                        input.value = 1
                    } else if (value > max_value) {
                        value = max_value
                        input.value = max_value
                    }
                    if (event.keyCode == 10 || event.keyCode == 13) {
                        window.location.href = "{{ url_for('user_albums', user_id=user.id) }}/" + value;
                    }
                });
            }
        </script>
    {% else %}
    <div class="users-container">
        <p>No albums found. Seems this user never created backup or albums. ;-)</p>
    </div>
    {% endif %}
{% endblock %}